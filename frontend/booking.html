{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Book your stay at Urban Oasis - secure your dates and send an inquiry.">
	<title>Urban Oasis â€” Booking</title>
	<link rel="icon" type="image/x-icon" href="{% static 'images/favicon.png' %}">
	<link rel="stylesheet" href="{% static 'static/style.css' %}">
	<link rel="stylesheet" href="{% static 'static/pricing-cards.css' %}">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
	<style>
		.payment-option {
			margin-bottom: 15px;
			padding: 15px;
			border: 2px solid #e8e8e8;
			border-radius: 6px;
			cursor: pointer;
			transition: all 0.3s ease;
		}
		.payment-option input[type="radio"] {
			margin-right: 10px;
			cursor: pointer;
		}
		.payment-option input[type="radio"]:checked {
			accent-color: #2f6f62;
		}
		.payment-option input[type="radio"]:checked ~ .payment-label-wrapper {
			color: #2f6f62;
		}
		.payment-option:hover {
			border-color: #8B4513;
			background: #fafafa;
		}
		.payment-option label {
			display: flex;
			align-items: center;
			margin: 0;
			font-weight: 500;
			width: 100%;
			cursor: pointer;
		}
		.payment-option label span {
			font-size: 15px;
			color: #333;
			font-weight: 600;
		}
		.payment-option input[type="radio"]:checked ~ .payment-label-wrapper span {
			color: #2f6f62;
		}
		.payment-logo {
			width: 45px;
			height: 45px;
			margin-right: 12px;
			display: flex;
			align-items: center;
			justify-content: center;
			background: #f9f9f9;
			border-radius: 6px;
			flex-shrink: 0;
			border: 1px solid #e8e8e8;
		}
		.payment-logo img {
			max-width: 85%;
			max-height: 85%;
			object-fit: contain;
		}
		.payment-label-wrapper {
			display: flex;
			align-items: center;
			flex: 1;
		}
		.bank-details-info {
			background: #f0f0f0;
			padding: 12px;
			border-radius: 4px;
			margin-top: 10px;
			font-size: 13px;
			line-height: 1.6;
			display: none;
			margin-bottom: 15px;
		}
		.bank-details-info p {
			margin: 0;
			color: #555;
		}
		.bank-details-info.show {
			display: block;
		}
		
		/* Debit Card Form Styles */
		.card-form {
			background: #f9f9f9;
			padding: 20px;
			border-radius: 8px;
			margin-top: 15px;
			margin-bottom: 15px;
			border: 1px solid #e8e8e8;
		}
		
		.card-form .form-group {
			margin-bottom: 15px;
		}
		
		.card-form label {
			display: block;
			font-weight: 500;
			color: #333;
			margin-bottom: 6px;
			font-size: 14px;
		}
		
		.card-input {
			width: 100%;
			padding: 10px 12px;
			border: 1px solid #ddd;
			border-radius: 4px;
			font-size: 14px;
			font-family: 'Courier New', monospace;
			transition: border-color 0.3s ease;
		}
		
		.card-input:focus {
			outline: none;
			border-color: #2f6f62;
			box-shadow: 0 0 0 3px rgba(47, 111, 98, 0.1);
		}
		
		.card-input::placeholder {
			color: #bbb;
		}
		
		.card-form small {
			display: block;
			margin-top: 4px;
			font-size: 12px;
		}
		
		.card-form .form-row {
			display: grid;
			grid-template-columns: 1fr 1fr;
			gap: 15px;
		}
		
		@media (max-width: 768px) {
			.card-form .form-row {
				grid-template-columns: 1fr;
			}
		}
	</style>
</head>
<body>
	<header class="navbar">
		<div class="logo">
        	<a href="{% url 'index' %}">
          	<img src="{% static 'images/urban_oasis.png' %}" alt="Urban Oasis Logo">Urban Oasis</a>
      	</div>
		<nav class="nav-links" id="navLinks">
			<a href="{% url 'index' %}" data-en="Home" data-es="Inicio" data-fr="Accueil">Home</a>
			<a href="{% url 'amenities' %}" data-en="Amenities" data-es="Servicios" data-fr="Ã‰quipements">Amenities</a>
			<a href="{% url 'gallery' %}" data-en="Gallery" data-es="GalerÃ­a" data-fr="Galerie">Gallery</a>
			<a href="{% url 'location' %}" data-en="Location" data-es="UbicaciÃ³n" data-fr="Emplacement">Location</a>
		</nav>
		<a href="{% url 'booking' %}"><button class="reserve-btn" data-en="Book Now" data-es="Reservar" data-fr="RÃ©server">Book Now</button></a>
		<div class="lang-switcher">
			<button id="langEn" class="lang-btn active">EN</button>
			<button id="langEs" class="lang-btn">ES</button>
			<button id="langFr" class="lang-btn">FR</button>
		</div>
		<div class="hamburger" id="hamburger"><span></span><span></span><span></span></div>
		<div class="menu-overlay" id="menuOverlay"></div>
	</header>

	<section class="hero" style="background-image: url({% static 'images/BEDROOM1A.jpg' %});">
		<div class="overlay"></div>
		<div class="hero-content">
			<p class="welcome" data-en="BOOK YOUR STAY" data-es="RESERVA TU ESTANCIA" data-fr="RÃ‰SERVEZ VOTRE SÃ‰JOUR">BOOK YOUR STAY</p>
			<h1 data-en="Reserve at Urban Oasis" data-es="Reserva en Urban Oasis" data-fr="RÃ©servez Ã  Urban Oasis">Reserve at Urban Oasis</h1>
			<p class="subtitle" data-en="Quick booking inquiry â€” we'll confirm availability within 24 hours." data-es="Consulta rÃ¡pida â€” confirmaremos disponibilidad en 24 horas." data-fr="Demande rapide â€” nous confirmerons la disponibilitÃ© dans 24 heures.">Quick booking inquiry â€” we'll confirm availability within 24 hours.</p>
			<a href="#booking" class="btn">Make a Booking</a>
		</div>
	</section>


<!-- Booking Section -->

	<section class="booking-section" id="booking">
		<div class="container">
			<div class="booking-header">
				<p class="booking-tag" data-en="READY TO STAY?" data-es="Â¿LISTO PARA QUEDARSE?" data-fr="PRÃŠT Ã€ SÃ‰JOURNER?">READY TO STAY?</p>
				<h2 data-en="Complete Your Reservation" data-es="Completa Tu Reserva" data-fr="ComplÃ©tez Votre RÃ©servation">Complete Your Reservation</h2>
				<p class="booking-desc" data-en="Fill out the form below and we'll confirm your dates within 24 hours." data-es="Completa el formulario y confirmaremos tus fechas en 24 horas." data-fr="Remplissez le formulaire et nous confirmerons vos dates dans 24 heures.">Fill out the form below and we'll confirm your dates within 24 hours.</p>
			</div>


			<!-- Pricing Plans Section -->
			<section class="pricing-section" style="margin-top: 60px;">
				<span class="section-tag" data-en="Pricing Plans" data-es="Planes de Precios" data-fr="Plans de Tarification">Pricing Plans</span>
            
				<h2 data-en="Flexible Pricing for Your Stay" data-es="Precios Flexibles para Tu Estancia" data-fr="Tarification Flexible pour Votre SÃ©jour">Flexible Pricing for Your Stay</h2>
				<p>Select a pricing plan that works best for your stay duration and season</p>
				<div id="pricingCards"></div>
			</section>



	<!-- Pricing Section HTML -->
<section id="pricing" class="pricing-section">
    <div class="container">
       <!-- Quick Price Calculator -->
        <div class="price-calculator-box">
            <h3 data-en="Calculate Your Price" data-es="Calcula Tu Precio" data-fr="Calculez Votre Prix">Calculate Your Price</h3>
            <div class="calc-inputs">
                <div class="calc-group">
                    <label data-en="Check-in" data-es="Entrada" data-fr="ArrivÃ©e">Check-in</label>
                    <input type="date" id="calc-checkin" required>
                </div>
                <div class="calc-group">
                    <label data-en="Check-out" data-es="Salida" data-fr="DÃ©part">Check-out</label>
                    <input type="date" id="calc-checkout" required>
                </div>
                <button class="reserve-btn" id="calc-btn" data-en="Calculate" data-es="Calcular" data-fr="Calculer">Calculate</button>
            </div>
            <div id="calc-result" class="calc-result hidden">
                <p data-en="Total:" data-es="Total:" data-fr="Total:">Total: <span id="calc-total">$0</span> for <span id="calc-nights">0</span> nights</p>
            </div>
        </div>

        </div>

        
    </div>
</section>


			<div class="booking-wrapper">
				<!-- Left: Form -->
				<div class="booking-form-container">
					<form id="bookingForm" class="booking-form">
						<!-- Personal Information -->
						<div class="form-section">
							<h3 data-en="Guest Information" data-es="InformaciÃ³n del HuÃ©sped" data-fr="Informations sur le Client">Guest Information</h3>
							
							<div class="form-group">
								<label for="name" data-en="Full Name *" data-es="Nombre Completo *" data-fr="Nom Complet *">Full Name *</label>
								<input type="text" id="name" name="name" placeholder="John Doe" required>
								<span class="error-msg" id="name-error"></span>
							</div>

							<div class="form-row">
								<div class="form-group">
									<label for="email" data-en="Email Address *" data-es="Correo ElectrÃ³nico *" data-fr="Adresse Email *">Email Address *</label>
									<input type="email" id="email" name="email" placeholder="john@example.com" required>
									<span class="error-msg" id="email-error"></span>
								</div>
								<div class="form-group">
									<label for="phone" data-en="Phone Number *" data-es="NÃºmero de TelÃ©fono *" data-fr="NumÃ©ro de TÃ©lÃ©phone *">Phone Number *</label>
									<input type="tel" id="phone" name="phone" placeholder="+1 (555) 123-4567" required>
									<span class="error-msg" id="phone-error"></span>
								</div>
							</div>
						</div>

						<!-- Stay Details -->
						<div class="form-section">
							<h3 data-en="Stay Details" data-es="Detalles de la Estancia" data-fr="DÃ©tails du SÃ©jour">Stay Details</h3>
							
							<div class="form-row">
								<div class="form-group">
									<label for="checkin" data-en="Check-in Date *" data-es="Fecha de Entrada *" data-fr="Date d'ArrivÃ©e *">Check-in Date *</label>
									<div class="date-input-wrapper">
										<i class="fas fa-calendar"></i>
										<input type="text" id="checkin" name="checkin" placeholder="Select date" required>
									</div>
									<span class="error-msg" id="checkin-error"></span>
								</div>
								<div class="form-group">
									<label for="checkout" data-en="Check-out Date *" data-es="Fecha de Salida *" data-fr="Date de DÃ©part *">Check-out Date *</label>
									<div class="date-input-wrapper">
										<i class="fas fa-calendar"></i>
										<input type="text" id="checkout" name="checkout" placeholder="Select date" required>
									</div>
									<span class="error-msg" id="checkout-error"></span>
								</div>
							</div>

							<div class="stay-info">
								<div class="info-item">
									<span data-en="Duration:" data-es="DuraciÃ³n:" data-fr="DurÃ©e:">Duration:</span>
									<strong id="duration-display">0 nights</strong>
								</div>
								<div class="info-item">
									<span data-en="Estimated Total:" data-es="Total Estimado:" data-fr="Total EstimÃ©:">Estimated Total:</span>
									<strong id="total-display">$0</strong>
								</div>
							</div>

							<div class="form-group">
								<label for="guests" data-en="Number of Guests *" data-es="NÃºmero de HuÃ©spedes *" data-fr="Nombre de Clients *">Number of Guests *</label>
								<div class="guest-selector">
									<button type="button" class="qty-btn" id="guests-minus"><i class="fas fa-minus"></i></button>
									<input type="number" id="guests" name="guests" value="1" min="1" max="10" required readonly>
									<button type="button" class="qty-btn" id="guests-plus"><i class="fas fa-plus"></i></button>
								</div>
								<span class="info-text" data-en="Maximum 10 guests" data-es="MÃ¡ximo 10 huÃ©spedes" data-fr="Maximum 10 clients">Maximum 10 guests</span>
							</div>
						</div>

						<!-- Preferences -->
						<div class="form-section">
							<!--<h3 data-en="Your Preferences" data-es="Tus Preferencias" data-fr="Vos PrÃ©fÃ©rences">Your Preferences</h3>
						
							<div class="form-group">
								<label data-en="Amenities of Interest" data-es="Servicios de InterÃ©s" data-fr="Ã‰quipements d'IntÃ©rÃªt">Amenities of Interest</label>
								<div class="checkbox-group">
									<label class="checkbox-label">
										<input type="checkbox" name="amenities" value="wifi"> <span data-en="High-Speed WiFi" data-es="WiFi de Alta Velocidad" data-fr="WiFi Haute Vitesse">High-Speed WiFi</span>
									</label>
									<label class="checkbox-label">
										<input type="checkbox" name="amenities" value="pool"> <span data-en="Swimming Pool" data-es="Piscina" data-fr="Piscine">Swimming Pool</span>
									</label>
									<label class="checkbox-label">
										<input type="checkbox" name="amenities" value="kitchen"> <span data-en="Full Kitchen" data-es="Cocina Completa" data-fr="Cuisine ComplÃ¨te">Full Kitchen</span>
									</label>
									<label class="checkbox-label">
										<input type="checkbox" name="amenities" value="parking"> <span data-en="Free Parking" data-es="Estacionamiento Gratis" data-fr="Stationnement Gratuit">Free Parking</span>
									</label>
								</div>
							</div>
							--->

							<div class="form-group">
								<label for="notes" data-en="Special Requests" data-es="Solicitudes Especiales" data-fr="Demandes SpÃ©ciales">Special Requests</label>
								<textarea id="notes" name="notes" placeholder="Tell us about any special needs or preferences..." rows="4"></textarea>
								<span class="char-count"><span id="char-count">0</span>/500</span>
							</div>
						</div>


						<!-- Payment -->
						<div class="form-section">
							<h3 data-en="Payment" data-es="Pago" data-fr="Paiement">Payment</h3>
							<div class="form-group">
								
								<div class="payment-option">
									<label>
										<input type="radio" name="payment_method" value="card">
										<div class="payment-label-wrapper">
											<div class="payment-logo">
												<img src="{% static 'images/Zelle-Logo-PNG.png' %}" alt="Zelle">
											</div>
											<span>Zelle</span>
										</div>
									</label>
								</div>
								<div class="bank-details-info" id="cardInfo">
									<p><strong>Recipient Email:</strong> jayeobabayo128@gmail.com</p>
									<p style="margin-top: 8px; color: #666; font-size: 13px;">Zelle transfers are typically processed within minutes. Please ensure the recipient email is correct and save your confirmation receipt.</p>
								</div>
								
								<div class="payment-option">
									<label>
										<input type="radio" name="payment_method" value="onarrival">
										<div class="payment-label-wrapper">
											<div class="payment-logo">
												<img src="{% static 'images/cashapp_logo.webp' %}" alt="Cash App">
											</div>
											<span>Cash App</span>
										</div>
									</label>
								</div>
								<div class="bank-details-info" id="arrivalInfo">
									<p><strong>Cashtag:</strong> $BayoT12344</p>
									<p style="margin-top: 8px; color: #666; font-size: 13px;">Quick and secure transfers. Please note the cashtag and include your booking reference in the payment note.</p>
								</div>
								
								<div class="payment-option">
									<label>
										<input type="radio" name="payment_method" value="debitcard">
										<div class="payment-label-wrapper">
											<div class="payment-logo">
												<i class="fas fa-credit-card" style="font-size: 24px; color: #2f6f62;"></i>
											</div>
											<span>Debit Card</span>
										</div>
									</label>
								</div>
								<div class="bank-details-info" id="debitcardInfo">
									<p style="color: #2f6f62; font-weight: 600;">ðŸ’³ Secure Card Payment</p>
									<p style="margin-top: 8px; color: #666; font-size: 13px;">Your card information is encrypted and secure. Payments are processed immediately.</p>
								</div>
								
						

								<!-- Debit Card Details Form -->
								<div id="debitcardDetails" class="card-form" style="display:none;">
									<div class="form-group">
										<label for="cardholderName">Cardholder Name *</label>
										<input type="text" id="cardholderName" name="cardholderName" placeholder="John Doe" class="card-input">
									</div>
									
									<div class="form-group">
										<label for="cardNumber">Card Number *</label>
										<input type="text" id="cardNumber" name="cardNumber" placeholder="1234 5678 9012 3456" maxlength="19" class="card-input" inputmode="numeric">
										<small style="color: #999;">16 digits</small>
									</div>
									
									<div class="form-row">
										<div class="form-group">
											<label for="cardExpiry">Expiry Date *</label>
											<input type="text" id="cardExpiry" name="cardExpiry" placeholder="MM/YY" maxlength="5" class="card-input" inputmode="numeric">
										</div>
										<div class="form-group">
											<label for="cardCVV">CVV *</label>
											<input type="text" id="cardCVV" name="cardCVV" placeholder="123" maxlength="4" class="card-input" inputmode="numeric">
										</div>
									</div>
									
									<div class="form-group">
										<label class="checkbox-label">
											<input type="checkbox" id="saveCard" name="saveCard">
											<span>Save this card for future bookings</span>
										</label>
									</div>
									
									<p style="font-size: 12px; color: #999; margin-top: 15px; padding-top: 15px; border-top: 1px solid #eee;">
										<i class="fas fa-lock" style="color: #2f6f62;"></i> 
										Your card details are encrypted and not stored on our servers. They are processed securely through our payment gateway.
									</p>
								</div>
															
							</div>
							
						</div>
					
						<!-- Privacy Policy -->
						<div class="form-section">
							<p>
								Your personal information is protected. Please review our 
								<a href="{% url 'privacy' %}" class="terms-link">privacy policy</a>
							</p>
						</div>
					
						<!-- Terms -->
						<div class="form-section">
							<label class="checkbox-label checkbox-large">
								<input type="checkbox" id="terms" name="terms" required>
								<span>
									I agree to the 
									<a href="#" id="open-terms" class="terms-link">terms and conditions</a> 
									and understand the cancellation policy
								</span>
							</label>
							<span class="error-msg" id="terms-error"></span>
						</div>
						<!-- Submit Button -->
						<button type="submit" class="reserve-btn submit-btn" data-en="Complete Reservation" data-es="Completar Reserva" data-fr="Confirmer la RÃ©servation">Complete Reservation</button>
					</form>



					<!-- Form Message -->
					<div id="formMessage" class="form-message"></div>
				</div>

				<!-- Right: Summary -->
				<div class="booking-summary">
					<h3 data-en="Booking Summary" data-es="Resumen de Reserva" data-fr="RÃ©sumÃ© de la RÃ©servation">Booking Summary</h3>
					
					<div class="summary-item">
						<span data-en="Check-in" data-es="Entrada" data-fr="ArrivÃ©e">Check-in</span>
						<strong id="summary-checkin">â€”</strong>
					</div>
					<div class="summary-item">
						<span data-en="Check-out" data-es="Salida" data-fr="DÃ©part">Check-out</span>
						<strong id="summary-checkout">â€”</strong>
					</div>
					<div class="summary-item">
						<span data-en="Number of Nights" data-es="NÃºmero de Noches" data-fr="Nombre de Nuits">Number of Nights</span>
						<strong id="summary-nights">0</strong>
					</div>
					<div class="summary-item">
						<span data-en="Number of Guests" data-es="NÃºmero de HuÃ©spedes" data-fr="Nombre de Clients">Number of Guests</span>
						<strong id="summary-guests">1</strong>
					</div>
					
					<hr class="summary-divider">
					
					<div class="summary-item breakdown">
						<span data-en="Base Price" data-es="Precio Base" data-fr="Prix de Base">Base Price</span>
						<span id="summary-base">$0</span>
					</div>
					<div class="summary-item breakdown" id="discount-row" style="display: none;">
						<span data-en="Discount" data-es="Descuento" data-fr="Remise">Discount</span>
						<span class="discount" id="summary-discount">-$0</span>
					</div>
				<div class="summary-item breakdown">
					<span data-en="Tax (4%)" data-es="Impuesto (4%)" data-fr="Taxe (4%)">Tax (4%)</span>
					<span id="summary-tax">$0</span>
				</div>
				
				<div class="summary-item total">
					<span data-en="Total Price" data-es="Precio Total" data-fr="Prix Total">Total Price</span>
					<strong id="summary-total">$0</strong>
				</div>

				<div class="summary-info">
					<i class="fas fa-info-circle"></i>
					<p data-en="Free cancellation up to 48 hours before check-in" data-es="CancelaciÃ³n gratuita hasta 48 horas antes de la entrada" data-fr="Annulation gratuite jusqu'Ã  48 heures avant l'arrivÃ©e">Free cancellation up to 48 hours before check-in</p>
				</div>
			</div>
		</div>
			</div>
		</div>
	</section>

	<!-- Footer -->
	<footer class="footer">
		<div class="footer-container">
			<div class="footer-about reveal">
				<div class="logo"><img src="{% static 'images/urban_oasis.png' %}" alt="Urban Oasis Logo">Urban Oasis</div>
				<h3>Urban Oasis</h3>
				<p>Experience the perfect blend of urban convenience and tranquil comfort in the heart of Killeen, Texas.</p>
			</div>
			<div class="footer-links reveal">
				<h4>Quick Links</h4>
				<ul>
					<li><a href="{% url 'amenities' %}">Amenities</a></li>
					<li><a href="{% url 'gallery' %}">Gallery</a></li>
					<li><a href="{% url 'booking' %}">Book Now</a></li>
					<li><a href="{% url 'location' %}">Location</a></li>
				</ul>
			</div>
			<div class="footer-contact reveal">
				<h4>Contact</h4>
				<p>5110 Daybreak Dr<br>Killeen, TX 76542</p>
				<p>+1 (254) 555-1234</p>
				<p>hello@urbanoasis.com</p>
			</div>
		</div>
		<div class="footer-bottom reveal">
			<p>Â© 2026 Urban Oasis. All rights reserved.</p>
			<div><a href="{% url 'privacy' %}" data-en="Privacy Policy" data-es="PolÃ­tica de Privacidad" data-fr="Politique de ConfidentialitÃ©">Privacy Policy</a> | <a href="{% url 'terms' %}" data-en="Terms of Service" data-es="TÃ©rminos de Servicio" data-fr="Conditions de Service">Terms of Service</a></div>
		</div>
	</footer>



<!-- Terms & Conditions Modal -->
<div id="termsModal" class="modal">
    <div class="modal-content">
        <span class="close-modal" id="closeTerms">Ã—</span>
        <h2>Terms and Conditions</h2>
        <p class="modal-update-date">Last updated: January 28, 2026</p>
        
        <div class="modal-body" id="termsContent">
            <h3>1. Overview</h3>
            <p>Welcome to Urban Oasis. These Terms of Service govern your use of our website, booking system, and rental properties. By accessing or booking through Urban Oasis, you agree to be bound by these terms.</p>

            <h3>2. User Eligibility</h3>
            <p>To use Urban Oasis services, you must:</p>
            <ul>
                <li>Be at least 18 years of age</li>
                <li>Provide accurate and complete information during registration</li>
                <li>Maintain a valid payment method on file</li>
                <li>Not have any outstanding disputes or violations with Urban Oasis</li>
                <li>Comply with all applicable laws and regulations</li>
            </ul>

            <h3>3. Booking Terms</h3>
            <p><strong>Reservation Confirmation</strong><br>A booking is only confirmed after payment is successfully processed and you receive a confirmation email. Urban Oasis reserves the right to cancel any booking that violates these terms or our house rules.</p>
            <p><strong>Check-in and Check-out</strong><br>Check-in time is 3:00 PM and check-out time is 11:00 AM. Early check-in or late check-out may be available for an additional fee, subject to availability. Urban Oasis is not responsible for early arrivals or luggage storage before official check-in time.</p>

            <h3>4. Cancellation & Refund Policy</h3>
            <p><strong>Cancellation by Guest</strong></p>
            <ul>
                <li><strong>Full Refund</strong>: Cancellations made more than 10 days before check-in date</li>
                <li><strong>50% Refund</strong>: Cancellations made 5 days before check-in date</li>
                <li><strong>No Refund</strong>: Cancellations made less than 7 days before check-in date</li>
            </ul>
            <p>Refunds will be processed within 5-7 business days after cancellation approval.</p>
            <p><strong>Cancellation by Urban Oasis</strong><br>Urban Oasis may cancel any reservation with full refund if: (a) the property becomes unavailable due to unforeseen circumstances; (b) there are safety concerns; (c) illegal activity is suspected; or (d) terms of service violations occur.</p>

            <h3>5. Payment Terms</h3>
            <p>Payment is due upon booking confirmation and must be made through our secure online payment system. We accept all major credit cards and digital payment methods. Pricing includes accommodation only; taxes and service fees are calculated and displayed at checkout.</p>
            <p><strong>Late Payment</strong><br>If payment is not received by the due date, Urban Oasis reserves the right to cancel the reservation without refund. Additionally, a late fee of 5% of the booking total may be applied.</p>

            <h3>6. Guest Responsibilities</h3>
            <p>Guests are responsible for:</p>
            <ul>
                <li>Maintaining the cleanliness and condition of the property</li>
                <li>Adhering to all house rules and local regulations</li>
                <li>Reporting any damages, maintenance issues, or concerns immediately</li>
                <li>Not disturbing other guests or neighbors</li>
                <li>Securing the property when leaving</li>
            </ul>

            <h3>7. Property Rules</h3>
            <p>The following rules must be observed at all times:</p>
            <ul>
                <li>No smoking inside the property (smoking is permitted on outdoor terraces only)</li>
                <li>No pets unless explicitly approved and documented</li>
                <li>No loud music or excessive noise after 10:00 PM</li>
                <li>No parties or gatherings exceeding the maximum occupancy limit</li>
                <li>No unauthorized guests staying overnight</li>
                <li>Guests must vacate by 11:00 AM on check-out day</li>
            </ul>
            <p>Violation of these rules may result in immediate eviction without refund.</p>

            <h3>8. Liability & Damages</h3>
            <p>Urban Oasis is not responsible for:</p>
            <ul>
                <li>Personal injury or accidents on the property</li>
                <li>Loss, theft, or damage to personal belongings</li>
                <li>Natural disasters or acts of God</li>
                <li>Interruption of utilities or services beyond reasonable control</li>
            </ul>
            <p><strong>Guest Liability</strong><br>Guests are fully liable for any damages to the property caused by negligence, misuse, or violation of house rules. Damage assessments will be conducted within 24 hours of checkout. Repair costs will be charged to the guest's payment method on file. Urban Oasis may pursue legal action for damages exceeding $5,000.</p>

            <h3>9. Dispute Resolution</h3>
            <p>In the event of a dispute between guest and Urban Oasis:</p>
            <ol>
                <li>The guest must contact Urban Oasis within 48 hours of the issue occurring</li>
                <li>Urban Oasis will provide written response within 5 business days</li>
                <li>If unresolved, disputes may be escalated to mediation or arbitration</li>
                <li>Legal proceedings, if necessary, will be governed by Texas law</li>
            </ol>

            <h3>10. Intellectual Property</h3>
            <p>All content on the Urban Oasis website, including text, images, logos, and designs, are protected by copyright and intellectual property laws. Unauthorized reproduction, distribution, or use of this content is strictly prohibited. Guests may not photograph or record the property for commercial purposes without written consent.</p>

            <h3>11. Modifications to Terms</h3>
            <p>Urban Oasis reserves the right to modify these Terms of Service at any time. Changes will be effective immediately upon posting to the website. Continued use of the website or booking system after modifications constitutes acceptance of the new terms. We recommend reviewing these terms regularly to stay informed of any updates.</p>

            <h3>12. Contact Information</h3>
            <p>If you have questions about these Terms of Service, please contact us:</p>
            <p><strong>Urban Oasis</strong><br>
            5110 Daybreak Dr<br>
            Killeen, TX 76541<br>
            Email: hello@urbanoasis.com<br>
            Phone: +1 (407) 900-6046</p>
            <p>We aim to respond to all inquiries within 30 business days.</p>


            <p style="text-align: center; font-weight: 600; font-size: 1em; color: #333; margin-top: 40px;">
                By accepting these terms, you confirm that you have read, understood, and agree to be bound by all the above provisions, including the cancellation policy and guest responsibilities.
            </p>
        </div>

        <div class="modal-footer">
            <button id="closeTermsBtn" class="reserve-btn">I've read and agree</button>
        </div>
    </div>
</div>


	<script src="https://js.stripe.com/v3/"></script>
	<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
	<script src="{% static 'static/pricing-cards.js' %}"></script>
	<script src="{% static 'static/booking-api.js' %}"></script>
	<script src="{% static 'static/script.js' %}"></script>
	<script>
		// Initialize Flatpickr for date fields
		const today = new Date().toISOString().split('T')[0];
		
		const checkInPicker = flatpickr('#checkin', {
			minDate: today,
			dateFormat: 'M j, Y',
			onChange: function() {
				updatePriceCalculation();
			}
		});

		const checkOutPicker = flatpickr('#checkout', {
			minDate: today,
			dateFormat: 'M j, Y',
			onChange: function() {
				updatePriceCalculation();
			}
		});

		// Calculate price on date change
		function updatePriceCalculation() {
			const checkin = document.getElementById('checkin').value;
			const checkout = document.getElementById('checkout').value;
			
			if (checkin && checkout) {
				const checkInDate = new Date(checkin);
				const checkOutDate = new Date(checkout);
				
				if (checkOutDate > checkInDate) {
					const nights = Math.floor((checkOutDate - checkInDate) / (1000 * 60 * 60 * 24));
					const rates = { nightly: 200, weekly: 1200, monthly: 4000 };
					let total = 0;
					let daysPerWeek = Math.floor(nights / 7);
					let remainingDays = nights % 7;
					
					total = (daysPerWeek * rates.weekly) + (remainingDays * 200);
					
					document.getElementById('duration-display').textContent = nights + ' night' + (nights !== 1 ? 's' : '');
					document.getElementById('summary-nights').textContent = nights;
					
					const basePrice = nights * 200;
					document.getElementById('summary-base').textContent = '$' + basePrice.toLocaleString();
					
					// Calculate discount
					if (nights >= 30) {
						const discount = basePrice - 4000;
						document.getElementById('summary-discount').textContent = '-$' + Math.round(discount).toLocaleString();
						document.getElementById('discount-row').style.display = 'flex';
					} else if (nights >= 7) {
						const discount = basePrice - total;
						document.getElementById('summary-discount').textContent = '-$' + Math.round(discount).toLocaleString();
						document.getElementById('discount-row').style.display = 'flex';
					} else {
						document.getElementById('discount-row').style.display = 'none';
					}
					
					// Calculate 4% tax on final amount after discount
					const taxAmount = Math.round(total * 0.04 * 100) / 100;
					document.getElementById('summary-tax').textContent = '$' + taxAmount.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2});
					
					// Calculate total with tax
					const totalWithTax = Math.round((total + taxAmount) * 100) / 100;
					document.getElementById('total-display').textContent = '$' + totalWithTax.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2});
					document.getElementById('summary-total').textContent = '$' + totalWithTax.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2});
					document.getElementById('summary-checkin').textContent = checkin;
					document.getElementById('summary-checkout').textContent = checkout;
				}
			}
		}

		// Guest quantity buttons
		document.getElementById('guests-minus').addEventListener('click', function(e) {
			e.preventDefault();
			const guestInput = document.getElementById('guests');
			if (guestInput.value > 1) guestInput.value--;
			document.getElementById('summary-guests').textContent = guestInput.value;
		});

		document.getElementById('guests-plus').addEventListener('click', function(e) {
			e.preventDefault();
			const guestInput = document.getElementById('guests');
			if (guestInput.value < 10) guestInput.value++;
			document.getElementById('summary-guests').textContent = guestInput.value;
		});

		// Price Calculator Button Handler
		const calcBtn = document.getElementById('calc-btn');
		if (calcBtn) {
			calcBtn.addEventListener('click', function(e) {
				e.preventDefault();
				const calcCheckin = document.getElementById('calc-checkin').value;
				const calcCheckout = document.getElementById('calc-checkout').value;
				
				if (!calcCheckin || !calcCheckout) {
					alert('Please select both check-in and check-out dates.');
					return;
				}
				
				const checkInDate = new Date(calcCheckin);
				const checkOutDate = new Date(calcCheckout);
				
				if (checkOutDate <= checkInDate) {
					alert('Check-out date must be after check-in date.');
					return;
				}
				
				const nights = Math.ceil((checkOutDate - checkInDate) / (1000 * 60 * 60 * 24));
				let total = 0;
				let daysPerWeek = Math.floor(nights / 7);
				let remainingDays = nights % 7;
				
				total = (daysPerWeek * 1200) + (remainingDays * 200);
				
				document.getElementById('calc-total').textContent = '$' + total.toLocaleString();
				document.getElementById('calc-nights').textContent = nights;
				document.getElementById('calc-result').classList.remove('hidden');
			});
		}

		// Character count for notes
		document.getElementById('notes').addEventListener('input', function() {
			document.getElementById('char-count').textContent = this.value.length;
		});

		// Payment method show/hide behavior
		function updatePaymentUI() {
			const method = document.querySelector('input[name="payment_method"]:checked') ? document.querySelector('input[name="payment_method"]:checked').value : '';
			
			const bankInfo = document.getElementById('bankInfo');
			const cardInfo = document.getElementById('cardInfo');
			const arrivalInfo = document.getElementById('arrivalInfo');
			const debitcardInfo = document.getElementById('debitcardInfo');
			const debitcardDetails = document.getElementById('debitcardDetails');

			// Hide all
			if (bankInfo) bankInfo.classList.remove('show');
			if (cardInfo) cardInfo.classList.remove('show');
			if (arrivalInfo) arrivalInfo.classList.remove('show');
			if (debitcardInfo) debitcardInfo.classList.remove('show');
			if (debitcardDetails) debitcardDetails.style.display = 'none';

			// Show selected
			if (method === 'bank' && bankInfo) bankInfo.classList.add('show');
			if (method === 'card' && cardInfo) cardInfo.classList.add('show');
			if (method === 'onarrival' && arrivalInfo) arrivalInfo.classList.add('show');
			if (method === 'debitcard' && debitcardInfo) debitcardInfo.classList.add('show');
			if (method === 'debitcard' && debitcardDetails) debitcardDetails.style.display = 'block';
		}

		// Attach event listeners when DOM is ready
		if (document.readyState === 'loading') {
			document.addEventListener('DOMContentLoaded', function() {
				document.querySelectorAll('input[name="payment_method"]').forEach(r => {
					r.addEventListener('change', updatePaymentUI);
				});
				updatePaymentUI(); // Initialize on load
			});
		} else {
			// DOM already loaded (script is after HTML)
			setTimeout(function() {
				document.querySelectorAll('input[name="payment_method"]').forEach(r => {
					r.addEventListener('change', updatePaymentUI);
				});
				updatePaymentUI(); // Initialize on load
			}, 100);
		}

		// Card number formatting (add spaces)
		const cardNumberEl = document.getElementById('cardNumber');
		if (cardNumberEl) {
			cardNumberEl.addEventListener('input', function(e) {
				let value = e.target.value.replace(/\s/g, '');
				let formattedValue = value.replace(/(.{4})/g, '$1 ').trim();
				e.target.value = formattedValue.substring(0, 19);
			});
		}

		// Card expiry formatting (MM/YY)
		const cardExpiryEl = document.getElementById('cardExpiry');
		if (cardExpiryEl) {
			cardExpiryEl.addEventListener('input', function(e) {
				let value = e.target.value.replace(/\D/g, '');
				if (value.length >= 2) {
					value = value.substring(0, 2) + '/' + value.substring(2, 4);
				}
				e.target.value = value.substring(0, 5);
			});
		}

		// CVV formatting (numbers only)
		const cardCVVEl = document.getElementById('cardCVV');
		if (cardCVVEl) {
			cardCVVEl.addEventListener('input', function(e) {
				e.target.value = e.target.value.replace(/\D/g, '').substring(0, 4);
			});
		}

		// Form validation and submission
		const bookingForm = document.getElementById('bookingForm');
		bookingForm.addEventListener('submit', async function(e) {
			e.preventDefault();

			// Validation
			let isValid = true;
			const errorElements = document.querySelectorAll('.error-msg');
			errorElements.forEach(el => el.textContent = '');

			const name = document.getElementById('name').value.trim();
			const email = document.getElementById('email').value.trim();
			const phone = document.getElementById('phone').value.trim();
			const checkin = document.getElementById('checkin').value;
			const checkout = document.getElementById('checkout').value;
			const terms = document.getElementById('terms').checked;
			const paymentMethod = document.querySelector('input[name="payment_method"]:checked') ? document.querySelector('input[name="payment_method"]:checked').value : '';
			
			if (!name) {
				document.getElementById('name-error').textContent = 'Please enter your name';
				isValid = false;
			}

			if (!email || !email.includes('@')) {
				document.getElementById('email-error').textContent = 'Please enter a valid email';
				isValid = false;
			}

			if (!phone) {
				document.getElementById('phone-error').textContent = 'Please enter your phone number';
				isValid = false;
			}

			if (!checkin) {
				document.getElementById('checkin-error').textContent = 'Please select check-in date';
				isValid = false;
			}

			if (!checkout) {
				document.getElementById('checkout-error').textContent = 'Please select check-out date';
				isValid = false;
			}

			if (!terms) {
				document.getElementById('terms-error').textContent = 'You must agree to the terms';
				isValid = false;
			}

			// Card validation for debit card payment
			let cardData = null;
			if (paymentMethod === 'debitcard') {
				const cardholderName = document.getElementById('cardholderName').value.trim();
				const cardNumber = document.getElementById('cardNumber').value.replace(/\s/g, '');
				const cardExpiry = document.getElementById('cardExpiry').value.trim();
				const cardCVV = document.getElementById('cardCVV').value.trim();

				if (!cardholderName) {
					alert('Please enter cardholder name');
					isValid = false;
				} else if (cardNumber.length !== 16 || isNaN(cardNumber)) {
					alert('Please enter a valid 16-digit card number');
					isValid = false;
				} else if (!/^\d{2}\/\d{2}$/.test(cardExpiry)) {
					alert('Please enter expiry date in MM/YY format');
					isValid = false;
				} else if (cardCVV.length < 3 || cardCVV.length > 4 || isNaN(cardCVV)) {
					alert('Please enter a valid CVV (3-4 digits)');
					isValid = false;
				} else {
					cardData = {
						name: cardholderName,
						number: cardNumber,
						expiry: cardExpiry,
						cvc: cardCVV
					};
				}
			}

			if (!isValid) return;

			// Calculate total price
			const checkinDate = new Date(checkin);
			const checkoutDate = new Date(checkout);
			const nights = Math.ceil((checkoutDate - checkinDate) / (1000 * 60 * 60 * 24));
			const totalPrice = nights * 200; // Base rate, should match your pricing

			// If paying by debit card, process with Stripe
			if (paymentMethod === 'debitcard' && cardData) {
				try {
					// Show loading
					const btn = bookingForm.querySelector('button[type="submit"]');
					const originalText = btn.textContent;
					btn.disabled = true;
					btn.textContent = 'Processing Payment...';

					// Fetch Stripe publishable key
					const pkResp = await fetch('/api/stripe-config/');
					const pkData = await pkResp.json();
					if (!pkResp.ok || !pkData.publishableKey) throw new Error('Stripe not configured');

					// Initialize Stripe
					const stripe = Stripe(pkData.publishableKey);

					// Parse expiry
					const [expMonth, expYear] = cardData.expiry.split('/');

					// Create payment method
					const paymentMethodResp = await stripe.createPaymentMethod({
						type: 'card',
						card: {
							number: cardData.number,
							exp_month: parseInt(expMonth),
							exp_year: parseInt('20' + expYear),
							cvc: cardData.cvc,
						},
						billing_details: {
							name: cardData.name,
							email: email,
						},
					});

					if (paymentMethodResp.error) {
						throw new Error(paymentMethodResp.error.message);
					}

					// Create PaymentIntent on backend
					const amountCents = Math.round(totalPrice * 100);
					const intentResp = await fetch('/api/create-payment-intent/', {
						method: 'POST',
						headers: {'Content-Type': 'application/json'},
						body: JSON.stringify({
							amount_cents: amountCents,
							currency: 'usd',
							metadata: {name: name, email: email}
						})
					});
					const intentData = await intentResp.json();
					if (!intentResp.ok) throw new Error(intentData.error || 'Failed to create payment intent');

					// Confirm payment
					const confirmResp = await stripe.confirmCardPayment(intentData.client_secret, {
						payment_method: paymentMethodResp.paymentMethod.id
					});

					if (confirmResp.error) {
						throw new Error(confirmResp.error.message);
					}

					if (confirmResp.paymentIntent && confirmResp.paymentIntent.status === 'succeeded') {
						// Create booking record after successful payment
						const [firstName, ...rest] = name.split(' ');
						const lastName = rest.join(' ') || '';
						
						const bookingPayload = {
							first_name: firstName,
							last_name: lastName,
							email: email,
							phone: phone,
							check_in: checkin,
							check_out: checkout,
							num_guests: parseInt(document.getElementById('guests').value) || 1,
							total_price: totalPrice.toFixed(2),
							status: 'confirmed',
							special_requests: document.getElementById('notes').value
						};

						const bookingResp = await fetch('/api/bookings/', {
							method: 'POST',
							headers: {'Content-Type': 'application/json'},
							body: JSON.stringify(bookingPayload)
						});

						if (bookingResp.ok) {
							const messageDiv = document.getElementById('formMessage');
							messageDiv.innerHTML = '<div class="success-message"><i class="fas fa-check-circle"></i> <strong>Payment successful!</strong><br>Your booking is confirmed. A confirmation email has been sent to ' + email + '</div>';
							messageDiv.style.display = 'block';
							messageDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
							bookingForm.reset();
							setTimeout(() => {
								messageDiv.style.display = 'none';
							}, 5000);
						} else {
							throw new Error('Failed to create booking');
						}
					} else {
						throw new Error('Payment was not successful');
					}
				} catch (error) {
					console.error('Stripe error:', error);
					alert('Payment failed: ' + error.message);
					const btn = bookingForm.querySelector('button[type="submit"]');
					btn.disabled = false;
					btn.textContent = 'Book Now';
				}
				return;
			}

			// Non-card payments: Zelle, Cash App
			const messageDiv = document.getElementById('formMessage');
			messageDiv.innerHTML = '<div class="success-message"><i class="fas fa-check-circle"></i> <strong>Booking inquiry received!</strong><br>We will contact you at ' + email + ' within 24 hours to confirm availability and payment instructions.</div>';
			messageDiv.style.display = 'block';
			messageDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });

			// Reset form
			bookingForm.reset();
			setTimeout(() => {
				messageDiv.style.display = 'none';
			}, 5000);
		});
	</script>
</body>
</html>
